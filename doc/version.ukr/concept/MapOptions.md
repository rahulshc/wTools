# Масив аргументів

Це сукупність параметрів рутини, котрі сформовано в псевдомасив <code>arguments</code>.

В JavaScript немає справжнього масиву аргументів, а є псевдомасив `arguments`. Під псевдомасивом розуміється те, що він має властивість `lenght` і кожен елемент індексується числом - `arguments[0]`, `arguments[1]`... Псевдомасив `arguments` має деякі властивості масивів, але застосування методів `Array`, наприклад, `indexOf`, `join`, призведе до викидання помилки.

За необхідності, з псевдомасиву `arguments` можна створити спражній масив

```js
  var args = [];
  for (var i = 0; i < arguments.length; i++)
  {
    args[i] = arguments[i];
  }
```

Після копіювання аргументів, елементи масиву `args` доступні для виконання операцій.

Кожну рутину в JavaScript можна викликати з необмеженою кількістю аргументів. При цьому аргументи можуть бути вказані в параметрах функції, або ж передаватись без об'явлення. До аргументів, об'явлених в параметрах рутини можна звернутись за іменем і за порядковим індексом в `arguments`. До аргументів, що не позначені в параметрах рутини можна звернутись тільки за індексом.

Для правильного виконання рутини, аргументи в масиві аргументів мають йти у визначеній послідовності. Ця властивість рутин з масивом аргументів може ускладнити роботу програміста пошуком (і, можливо, запам'ятовуванням) порядку аргументів для кожної рутини.

### Приклад

```js
function logMsgs( msg1, msg2 )
{
  if( msg1 && !msg2 )
  console.log( msg1 );
  if( !msg1 && msg2 )
  console.log( msg2, arguments[ 1 ] );  // two variants of calls of signed parameter
  if( arguments[ 2 ] )
  console.log( arguments[ 2 ] );
}

logMsgs( 'one' ); // returns one
logMsgs( null, 'two' ) // returns two two
logMsgs( null, undefined, 'three' ) // returns three
logMsgs( 'one', 'two', 'three', 'four', 'five' ) // returns three
```

В приведеному прикладі рутина `logMsgs` виводить в консоль повідомлення використовуючи передані аргументи. Рутина містить два параметри `msg1` i `msg2`. В коді рутини до параметрів звертаються як за назвою, так і за індексом в `arguments`

```js
console.log( msg2, arguments[ 1 ] );
```

В рутині `logMsgs` не вказаний третій параметр, тому його виклик можливий тільки через індекс в `arguments`.

За кодом рутини `logMsgs` проводиться її виклик з різною кількістю переданих аргументів. В першому випадку в рутину передано один аргумент, і рутина виведе повідомлення з ним. Другий і третій рядок показують, що відсутній аргумент позначається як `null` або `undefined`. В четвертому рядку передано більше аргументів ніж описано кодом рутини - це не порушує її роботи.

# Мапа опцій

Це контейнер, що призначений для передачі даних в рутину та управління її поведінкою.

Із мапою опцій працювати зручніше ніж із масивом аргументів так як кожна опція має ім'я, тоді як в масиві аргументів ідентифікація опції здійснюється по порядковому номеру. В масиві аргументів, всі опції мають йти послідовно, а в мапі опцій порядок указання опцій не має значення тому, програмісту достатньо знати тільки імя опції і її тип.

Мапа опцій може встановлюватись за замовчуванням ( вказуватись безпосередньо в коді рутини ) або ж автоматично генеруватись з інших даних та передаватись в рутину.

Мапи опцій за замовчуванням зберігають налаштування рутини, в свою чергу, це дозволяє створювати нові рутини використовуючи код існуючої. В такому разі, поведінка нової рутини буде відмінною за рахунок використання зміненої мапи опцій.  

Мапи опцій, що генеруються іншими рутинами призначені для обробки комплесних та інших змінних даних, наприклад, вводу користувача.

### Приклад використання мапи опцій

```js
function someFunction()
{
  let mapOptions = someFunction.defaults;
  if( mapOptions.option1 >= 0 )
  {
    console.log( 'option1' );
    // some code
  }

  if( mapOptions.option2 === 1 )
  {
    console.log( 'option2' );
    // some code
  }
  // some code
}

someFunction.defaults =
{
  option1 : 0,
  option2 : 1,
};

someFunction(); // option1 option2
```

Вище вказано спрощений приклад використання мапи опцій. Рутина `someFunction` виводить в консоль рядок з назвою опції та далі виконує код в залежності від того, яка з опцій встановлена. Для використання налаштувань за замовчуванням в рутині відразу ініціалізується мапа опцій `let mapOptions = someFunction.defaults;`, котра встановлює поведінку обробки вхідних даних виконання рутини.

Мапа опцій з налаштуваннями за замовчуванням - це зручний спосіб зберігати налаштування рутини в одному місці.

```js
function someFunction( mapOptions )
{
  if( mapOptions.option1 === 0 )
  {
    console.log( 'option1' );
    // some code
  }

  if( mapOptions.option2 === 1 )
  {
    console.log( 'option2' );
    // some code
  }
  // some code
}

someFunction( { option1 : 0, option2 : 0 } ); // option1
```

В приведеному вище прикладі рутина `someFunction` приймає аргументом мапу опцій. Цей спосіб використання має переваги в порівнянні з першим:

- можливість використання мапи опцій, що згенеровані іншими рутинами;
- можливість перевірки коректності значень мапи опцій при її створенні, до виконання рутини;
- можливість створення нових рутин перевикористанням коду початкової рутини. Для цього потрібно створити нову рутину з викликом першої та передати мапу їй потрібну мапу опцій:


```js
function someFunction( mapOptions )
{
  if( mapOptions.option1 === 0 )
  {
    console.log( 'option1' );
    // some code
  }

  if( mapOptions.option2 === 1 )
  {
    console.log( 'option2' );
    // some code
  }
  // some code
}

function someFunction2( mapOptions )
{
  if( mapOptions.option1 === null || mapOptions.option1 === undefined )
  mapOptions.option1 = someFunction2.defaults.option1;
  mapOptions.option2 = someFunction2.defaults.option2;
  let result = someFunction( mapOptions );
  // some code

}

someFunction2.defaults =
{
  option1 : 1,
  option2 : 1,
};

someFunction2( { option1 : 0, option2 : 0 } ); // option1 option2
```

Приклад демонструє як рутина `someFunction2` використовує код рутини `someFunction`. В приведеному прикладі мапа опцій формується з двох частин - переданого аргумента, та налаштувань за замовчуванням. Якщо опція `option1` не визначена, їй присвоюється значення з мапи опцій рутини `someFunction2`. Значення опції `option2` завжди встановлюється з мапи опцій за замовчуванням.

### Підсумок

- Кожна рутина має масив ([псевдомасив](#Масив-аргументів)) аргументів `arguments`.
- Доступ до елементів псевдомасиву `arguments` здійснюється за індексом, як в звичайних масивах.
- При використанні масиву аргументів передача аргументів має йти у визначеній послідовності, це може ускладнити роботу програміста пошуком цієї послідовності.
- Використання масиву аргументів в рутинах ускладнює передачу значень за замовчуванням.
- Мапа опцій зручніша в використанні, оскільки доступ до опцій здійснюється за іменем і порядок опцій не має значення.
- Мапа опцій за замовчуванням дозволяє зберігати налаштування рутини в одному місці.
- Мапа опцій дозволяє перевикористати код рутини змінивши налаштування за замовчуванням.
- Мапа опцій може генеруватись іншими рутинами.
- На етапі створення мапи опцій, інші рутини можуть виконати перевірку коректності даних.
- Комбінування мапи опцій за замовчуванням і переданої ззовні дозволяє легко змінювати поведінку рутини.

[Повернутись до змісту](../README.md#Концепції)
